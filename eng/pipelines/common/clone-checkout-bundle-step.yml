parameters:
  cloneFolder: ''

steps:
- checkout: none

- download: current
  artifact: Checkout_bundle
  displayName: Download Checkout.bundle

- ${{ if neq(parameters.cloneFolder, '') }}:
  - script: |
      $(setScriptToEchoAndFailOnNonZero)
      mkdir ${{ parameters.cloneFolder }}
      chdir ${{ parameters.cloneFolder }}
      git clone $(Pipeline.Workspace)/Checkout_bundle/Checkout.bundle ${{ parameters.cloneFolder }}
      git remote set-url origin $(Build.Repository.Uri)
    displayName: Clone the repository from Checkout.bundle

- ${{ if eq(parameters.cloneFolder, '') }}:
  - script: |
      $(setScriptToEchoAndFailOnNonZero)
      git clone $(Pipeline.Workspace)/Checkout_bundle/Checkout.bundle .
      git remote set-url origin $(Build.Repository.Uri)
    displayName: Clone the repository from Checkout.bundle
